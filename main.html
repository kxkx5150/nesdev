<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
  </head>
  <body>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-1">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">
          Nerdy Nights week 1: number systems and core programming ideas
        </h2>
      </div>
      <div class="mdl-card__supporting-text">
        <font size="+1">Number Systems</font><br />
        <b>Decimal</b><br />
        The decimal system is base 10. Every digit can be 0-9. Each digit place is a power of 10. Each
        digit place to the left is 10 times more than the previous digit place. If you take the number 10
        and put a 0 to the right, it becomes 100 which is 10 times more. Remove the 0 from the right, it
        becomes 1 which is 10 times less.<br />
        &nbsp;
        <pre>
100's place    10's place    1's place
0              0            1         = 001
0              1            0         = 010
1              0            0         = 100</pre
        >
        <br />
        To get the value of a number, you multiply each digit by it's place value and add them all
        together.<br />
        &nbsp;
        <pre>
100's place    10's place    1's place
3              8            0         = 3*100 + 8*10 + 0*1 = 380
0              4            1         = 0*100 + 4*10 + 1*1 = 41</pre
        >
        <br />
        <b>Binary</b><br />
        Everything in computers is done in base 2, binary. This is because the lowest level of computing
        is a switch; on/off, 1/0.<br />
        <br />
        Base 2 binary works the same way, except each digit can be 0-1 and the place values are powers of
        2 instead of 10. Insert a 0 to the right of a number and it becomes 2 times bigger. Remove a 0
        and it becomes 2 times smaller.<br />
        &nbsp;
        <pre>
8's place    4's place    2's place   1's place
0            1            0           0       = 0*8 + 1*4 + 0*2 + 0*1 = 4
1            1            1           1       = 1*8 + 1*4 + 1*2 + 1*1 = 15</pre
        >
        <br />
        The NES is an 8 bit system, which means the binary number it works with are 8 binary digits long.
        8 bits is one byte. Some examples are:<br />
        &nbsp;
        <pre>
 Binary    Decimal
00000000 =  0
00001111 =  15
00010000 =  16
10101010 =  170
11111111 =  255</pre
        >
        <br />
        Eventually you become fast at reading binary numbers, or at least recognizing patterns. You can
        see that one byte can only range from 0-255. For numbers bigger than that you must use 2 or more
        bytes. There are also no negative numbers. More on that later.<br />
        <br />
        <br />
        <b>Hexadecimal</b><br />
        Hexadecimal or Hex is base 16, so each digit is 0-15 and each digit place is a power of 16. The
        problem is anything 10 and above needs 2 digits. To fix this letters are used instead of numbers
        starting with A:<br />
        &nbsp;
        <pre>
Decimal   Hex
0   =  0
1   =  1
9   =  9
10   =  A
11   =  B
12   =  C
13   =  D
14   =  E
15   =  F</pre
        >
        <br />
        As with decimal and hex the digit places are each a power of 16:<br />
        &nbsp;
        <pre>
 16's place   1's place
6           A       = 6*16 + A(10)*1 = 106
1           0       = 1*16 +     0*1 = 16</pre
        >
        <br />
        Hex is largely used because it is much faster to write than binary. An 8 digit binary number
        turns into a 2 digit hex number:<br />
        &nbsp;
        <pre>Binary     01101010
split        |  |
in half     /    \
0110   1010
into       |     |
hex       6     A
|     |
put       \    /
back        6A
<br><br> 01101010 = 6A</pre>
        <br />
        <br />
        And more examples:
        <pre>
Binary     Hex   Decimal 
00000000 = 00  = 0
00001111 = 0F  = 15
00010000 = 10  = 16
10101010 = AA  = 170
11111111 = FF  = 255</pre
        >
        <br />
        For easy converting open up the built in Windows calculator and switch it to scientific mode.
        Choose the base (Hex, Dec, or Bin), type the number, then switch to another base.<br />
        <br />
        When the numbers are written an extra character is added so you can tell which base is being
        used. Binary is typically prefixed with a %, like %00001111. Hex is prefixed with a $ like $2A.
        Some other conventions are postfixing binary with a b like 00001111b and postfixing hex with an h
        like 2Ah.<br />
        <br />
        The NES has a 16 bit address bus (more on that later), so it can access 2^16 bytes of memory. 16
        binary digits turns into 4 hex digits, so typical NES addresses look like $8000, $FFFF, and
        $4017.<br />
        <br />
        <br />
        <font size="+1">Core Programming Concepts</font><br />
        All programming languages have three basic concepts. They are instructions, variables, and
        control flow. If any of those three are missing it is no longer a true programming language. For
        example HTML has no control flow so it is not a programming language.<br />
        <br />
        <b>Instructions</b><br />
        An instruction is the smallest command that the processor runs. Instructions are run one at a
        time, one after another. In the NES processor there are only 56 instructions. Typically around 10
        of those will be used constantly, and at least 10 will be completely ignored. Some examples of
        these would be addition, loading a number, or comparing a variable to zero.<br />
        <br />
        <b>Variables</b><br />
        A variable is a place that stores data that can be modified. An example of this would be the
        vertical position of Mario on the screen. It can be changed any time during the game. Variables
        in source code all have names you set, so it would be something like MarioHorizPosition.<br />
        <br />
        <b>Control Flow</b><br />
        Normally your instructions run in sequential order. Sometimes you will want to run a different
        section of code depending on a variable. This would be a control flow statement which changes the
        normal flow of your program. An example would be if Mario is falling, jump to the code that
        checks if he hit the ground yet.<br />
        <br />
        <br />
        <br />
        <b>NEXT WEEK: basic NES architecture</b>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-1__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4147"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-2">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 2: NES architecture overview</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <b
          ><a
            href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4147"
            target="_blank"
            original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4147"
            >Previous week:</a
          ></b
        >
        number systems and core programming ideas<br /><br />
        <b>This week:</b> general overview of the NES architecture with the major components covered. All
        general purpose computers are arranged the same way with a place to store code (ROM), a place to
        store variables (RAM), and a processor to run code (CPU). The NES also adds another processor to
        generate the graphics (PPU) and a section of the CPU to generate audio (APU). Everything here is
        very general and will have more details than you want in the next few weeks. <br /><br />
        <font size="+1">NES System Architecture</font><br />
        <br />
        <i
          >KB - Memory size is listed in KiloBytes or KB. 1KB = 1024 bytes. Everything is powers of 2, so
          2^10 = 1024 is used instead of 1000. If the capitalization is different, the meaning can
          change. Kb is Kilobits. Divide Kb by 8 to get KB, because 1 byte = 8 bits. <br /><br />
          ROM - Read Only Memory, holds data that cannot be changed. This is where the game code or
          graphics is stored on the cart.
          <br /><br />
          RAM - Random Access Memory, holds data that can be read and written. When power is removed, the
          chip is erased. A battery can be used to keep power and data valid.
          <br /><br />
          PRG - Program memory, the code for the game
          <br /><br />
          CHR - Character memory, the data for graphics
          <br /><br />
          CPU - Central Processing Unit, the main processor chip
          <br /><br />
          PPU - Picture Processing Unit, the graphics chip
          <br /><br />
          APU - Audio Processing Unit, the sound chip inside the CPU</i
        >
        <br /><br />
        <br /><br />
        <b>System Overview</b>
        <br /><br />
        The NES includes a custom 6502 based CPU with the APU and controller handling inside one chip,
        and a PPU that displays graphics in another chip. Your code instructions run on the CPU and sends
        out commands to the APU and PPU. The NOAC (NES On A Chip) clones like the Yobo and NEX put all of
        these parts onto one chip.
        <br /><br />
        <img
          src="img/nesarchitecture.png"
          original-src="http://www.nesmuseum.com/images/nesarchitecture.png"
          show-src="img/nesarchitecture.png"
        /><br />
        <img
          src="img/nesboard.png"
          original-src="http://www.nesmuseum.com/images/nesboard.png"
          show-src="img/nesboard.png"
        /><br />
        <br />
        There is only 2KB of RAM connected to the CPU for storing variables, and 2KB of RAM connected to
        the PPU for holding two TV screens of background graphics. Some carts add extra CPU RAM, called
        Work RAM or WRAM. If a cart needs to store saved games, this WRAM will have a battery attached to
        make sure it isn't erased. A few carts add extra PPU RAM to hold four screens of background
        graphics at once. This is not common. The rest of this tutorial will not use WRAM or four screen
        RAM.
        <br /><br />
        Each cart includes at least three chips. One holds the program code (PRG), another holds the
        character graphics (CHR), and the last is the lockout. The graphics chip can be RAM instead of
        ROM, which means the game code would copy graphics from the PRG ROM chip to the CHR RAM. PRG is
        always a ROM chip.
        <br /><br /><br />
        <b>Lockout Chip</b><br />
        Inside the NES and the cart are also two lockout chips. The lockout chip controls resetting the
        console. First the NES lockout sends out a stream ID, 0-15. The cart lockout records this number.
        Then both lockout chips run a complex equation using that number and send the results to each
        other. Both chips know what the other is supposed to send so they both know when something is
        wrong. If that happens the system enters the continuous reseting loop. This is the screen
        flashing you see with a dirty cart.
        <br /><br />
        When you cut pin 4 of the NES lockout chip, you are making it think it is inside the cart. It
        sits there waiting for the ID from the NES which never happens, so the system is never reset. If
        you were to completely remove the NES lockout chip the system would not work because it controls
        the reset button.
        <br /><br />
        Most lockout defeaters used by the unlicensed game companies used large voltage spikes sent from
        the cart to the NES lockout. When timed right those would crash the NES lockout, preventing it
        from resetting the system. Nintendo slowly added protection against those on the NES board. Next
        time you open your NES, check the board for the revision number. Right in the middle it will say
        NES-CPU- then a number. That number is the revision. If you have 05 it is an early one. 07 and 09
        added some lockout protection. 11 was the last version with the most lockout protection. Almost
        all unlicensed carts that use lockout defeaters will not work on a NES-CPU-11 system.
        <br /><br /><br />
        <b>CPU Overview</b><br />
        The NES CPU is a modified 6502, an 8 bit data processor similar to the Apple 2, Atari 2600, C64,
        and many other systems. By the time the Famicom was created it was underpowered for a computer
        but great for a game system.
        <br /><br />
        The CPU has a 16 bit address bus which can access up to 64KB of memory. 2^16 = 65536, or 64KB.
        Included in that memory space is the 2KB of CPU RAM, ports to access PPU/APU/controllers, WRAM
        (if on the cart), and 32KB for PRG ROM. The 16 bit addresses are written in hex, so they become 4
        digits starting with a $ symbol. For example the internal RAM is at $0000-0800. $0800 = 2048 or
        2KB. 32KB quickly became too small for games, which is why memory mappers were used. Those
        mappers can swap in different banks of PRG code or CHR graphics. Mappers like the MMC3 allowed up
        to 512KB of PRG, and 256KB of CHR. There is no limit to the memory size if you create a new
        mapper chip, but 128KB PRG and 64KB CHR was the most common size. <br />
        <br />
        <img
          src="img/cpumemmap.png"
          original-src="http://www.nesmuseum.com/images/cpumemmap.png"
          show-src="img/cpumemmap.png"
        /><br />
        <br /><br />
        <b>PPU Overview</b><br />
        The NES PPU is a custom chip that does all the graphics display. It includes internal RAM for
        sprites and the color palette. There is RAM on the NES board that holds the background, and all
        actual graphics are fetched from the cart CHR memory.
        <br /><br />
        Your program does not run on the PPU, the PPU always goes through the same display order. You
        only set some options like colors and scrolling. The PPU processes one TV scanline at a time.
        First the sprites are fetched from the cart CHR memory. If there are more than 8 sprites on the
        scanline the rest are ignored. This is why some games like Super Dodge Ball will blink when there
        is lots happening on screen. After the sprites the background is fetched from CHR memory. When
        all the scanlines are done there is a period when no graphics are sent out. This is called VBlank
        and is the only time graphics updates can be done. PAL has a longer VBlank time (when the TV
        cathode ray gun is going back to the top of the screen) which allows more time for graphics
        updates. Some PAL games and demos do not run on NTSC systems because of this difference in VBlank
        time. Both the NTSC and PAL systems have a resolution of 256x240 pixels, but the top and bottom 8
        rows are typically cut off by the NTSC TV resulting in 256x224. TV variations will cut off an
        additional 0-8 rows, so you should allow for a border before drawing important information.
        <br /><br />
        NTSC runs at 60Hz and PAL runs at 50Hz. Running an NTSC game on a PAL system will be slower
        because of this timing difference. Sounds will also be slower.
        <br /><br />
        <img
          src="img/ppumemmap.png"
          original-src="http://www.nesmuseum.com/images/ppumemmap.png"
          show-src="img/ppumemmap.png"
        />
        <br /><br /><br /><br /><br />
        <font size="+1">Graphics System Overview</font><br /><br />
        <b>Tiles</b><br />
        All graphics are made up of 8x8 pixel tiles. Large characters like Mario are made from multiple
        8x8 tiles. All the backgrounds are also made from these tiles. The tile system means less memory
        is needed (was expensive at the time) but also means that things like bitmap pictures and 3d
        graphics aren't really possible. To see all the tiles in a game, download
        <a
          href="downloads/missing/tilemolester-0.16.zip"
          target="_blank"
          original-href="http://www.zophar.net/utilities/download/TileMolester_015a_bin.zip"
          >Tile Molester</a
        >
        and open up your .NES file. Scroll down until you see graphics that don't look like static. You
        can see that small tiles are arranged by the game to make large images.<br />
        <b>Sprites</b><br />
        The PPU has enough memory for 64 sprites, or things that move around on screen like Mario. Only 8
        sprites per scanline are allowed, any more than that will be ignored. This is where the
        flickering comes from in some games when there are too many objects on screen.<br />
        <b>Background</b><br />
        This is the landscape graphics, which scrolls all at once. The sprites can either be displayed in
        front or behind the background. The screen is big enough for 32x30 background tiles, and there is
        enough internal RAM to hold 2 screens. When games scroll the background graphics are updated off
        screen before they are scrolled on screen.
        <br />
        <b>Pattern Tables</b><br />
        These are where the actual tile data is stored. It is either ROM or RAM on the cart. Each pattern
        table holds 256 tiles. One table is used for backgrounds, and the other for sprites. All graphics
        currently on screen must be in these tables.<br />
        <b>Attribute Tables</b><br />
        These tables set the color information in 2x2 tile sections. This means that a 16x16 pixel area
        can only have 4 different colors selected from the palette.<br />
        <b>Palettes</b><br />
        These two areas hold the color information, one for the background and one for sprites. Each
        palette has 16 colors.<br /><br />
        To display a tile on screen, the pixel color index is taken from the Pattern Table and the
        Attribute Table. That index is then looked up in the Palette to get the actual color.<br /><br />
        <img
          src="img/pputile.png"
          original-src="http://www.nesmuseum.com/images/pputile.png"
          show-src="img/pputile.png"
        />
        <br /><br /><br />
        To see all the graphics, download the
        <a
          href="http://www.the-interweb.com/serendipity/exit.php?url_id=627&amp;entry_id=90"
          target="_blank"
          original-href="http://www.the-interweb.com/serendipity/exit.php?url_id=627&amp;entry_id=90"
          >FCEUXD SP emulator</a
        >. Open up your .NES game and choose PPU Viewer from the Tools menu. This will show you all the
        active background tiles, all the active sprite tiles, and the color palettes. Then choose Name
        Table Viewer from the Tools menu. This will show you the backgrounds as they will appear on
        screen. If you choose a game that scrolls like SMB you can see the off screen background sections
        being updated. <br /><br /><br />
        <b>NEXT WEEK:</b> CPU details, start of 6502 assembly programming
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-2__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4291"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-3">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 3: 6502 ASM, first app</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <a
          href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4291"
          target="_blank"
          original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4291"
          >Previous Week</a
        >
        - NES architecture overview<br /><br />
        <b>This Week:</b> starts getting into more details about the 6502 and intro to assembly language.
        The lessons for asm usage and NES specifics will be done in sections together. There are many
        other 6502
        <a
          href="http://www.obelisk.demon.co.uk/6502/"
          target="_blank"
          original-href="http://www.obelisk.demon.co.uk/6502/"
          >websites</a
        >
        and good books which may help you learn better.<br /><br /><br /><br /><font size="+2"
          >6502 Assembly</font
        ><br />
        <i
          >Bit - The smallest unit in computers. It is either a 1 (on) or a 0 (off), like a light switch.
          <br /><br />
          Byte - 8 bits together form one byte, a number from 0 to 255. Two bytes put together is 16
          bits, forming a number from 0 to 65535. Bits in the byte are numbered starting from the right
          at 0.<br /><br />
          Instruction - one command a processor executes. Instructions are run sequentially.</i
        >
        <br /><br />
        <font size="+1">Code Layout</font><br />
        In assembly language there are 5 main parts. Some parts must be in a specific horizontal position
        for the assembler to use them correctly.<br /><br />
        <b>Directives</b><br />
        Directives are commands you send to the assembler to do things like locating code in memory. They
        start with a . and are indented. Some people use tabs, or 4 spaces, and I use 2 spaces. This
        sample directive tells the assembler to put the code starting at memory location $8000, which is
        inside the game ROM area:<br />
        <pre>  .org $8000</pre>
        <br />
        <b>Labels</b><br />
        The label is aligned to the far left and has a : at the end. The label is just something you use
        to organize your code and make it easier to read. The assembler translates the label into an
        address. Sample label:<br />
        <pre>  .org $8000<br>MyFunction:<br></pre>
        When the assembler runs, it will do a find/replace to set MyFunction to $8000. The if you have
        any code that uses MyFunction like:<br />
        <pre>  STA MyFunction<br></pre>
        It will find/replace to:<br />
        <pre>  STA $8000<br></pre>
        <br />
        <b>Opcodes</b><br />
        The opcode is the instruction that the processor will run, and is indented like the directives.
        In this sample, JMP is the opcode that tells the processor to jump to the MyFunction label:<br />
        <pre>  .org $8000<br>MyFunction:<br>  JMP MyFunction<br></pre>
        <br />
        <b>Operands</b><br />
        The operands are additional information for the opcode. Opcodes have between one and three
        operands. In this example the #$FF is the operand:<br />
        <pre>  .org $8000<br>MyFunction:<br>  LDA #$FF<br>  JMP MyFunction<br></pre>
        <br />
        <b>Comments</b><br />
        Comments are to help you understand in English what the code is doing. When you write code and
        come back later, the comments will save you. You do not need a comment on every line, but should
        have enough to explain what is happening. Comments start with a ; and are completely ignored by
        the assembler. They can be put anywhere horizontally, but are usually spaced beyond the long
        lines.<br />
        <pre>  .org $8000<br>MyFunction:        ; loads FF into accumulator<br>  LDA #$FF<br>  JMP MyFunction<br></pre>
        This code would just continually run the loop, loading the hex value $FF into the accumulator
        each time.<br />
        <br /><br /><br /><font size="+1">6502 Processor Overview</font><br />
        The 6502 is an 8 bit processor with a 16 bit address bus. It can access 64KB of memory without
        bank switching. In the NES this memory space is split up into RAM, PPU/Audio/Controller access,
        and game ROM.<br />
        <pre>$0000-0800 - Internal RAM, 2KB chip in the NES<br>$2000-2007 - PPU access ports<br>$4000-4017 - Audio and controller access ports<br>$6000-7FFF - Optional WRAM inside the game cart<br>$8000-FFFF - Game cart ROM<br></pre>
        Any of the game cart sections can be bank switched to get access to more memory, but memory
        mappers will not be included in this tutorial.<br /><br /><br /><br />
        <font size="+1">6502 Assembly Overview</font><br />
        The assembly language for 6502 starts with a 3 character code for the instruction "opcode". There
        are 56 instructions, 10 of which you will use frequently. Many instructions will have a value
        after the opcode, which you can write in decimal or hex. If that value starts with a # then it
        means use the actual number. If the value doesn't have then # then it means use the value at that
        address. So LDA #$05 means load the value 5, LDA $0005 means load the value that is stored at
        address $0005.<br /><br /><br /><br /><font size="+1">6502 Registers</font><br />
        A register is a place inside the processor that holds a value. The 6502 has three 8 bit registers
        and a status register that you will be using. All your data processing uses these registers.
        There are additional registers that are not covered in this tutorial.<br /><br />
        <b>Accumulator</b><br />
        The Accumulator (A) is the main 8 bit register for loading, storing, comparing, and doing math on
        data. Some of the most frequent operations are:<br />
        <pre>LDA #$FF  ;load the hex value $FF (decimal 256) into A<br>STA $0000 ;store the accumulator into memory location $0000, internal RAM<br></pre>
        <br />
        <b>Index Register X</b><br />
        The Index Register X (X) is another 8 bit register, usually used for counting or memory access.
        In loops you will use this register to keep track of how many times the loop has gone, while
        using A to process data. Some frequent operations are:<br />
        <pre>LDX $0000 ;load the value at memory location $0000 into X<br>INX       ;increment X   X = X + 1<br></pre>
        <br />
        <b>Index Register Y</b><br />
        The Index Register Y (Y) works almost the same as X. Some instructions (not covered here) only
        work with X and not Y. Some operations are:
        <pre>STY $00BA ;store Y into memory location $00BA<br>TYA       ;transfer Y into Accumulator<br></pre>
        <br />
        <b>Status Register</b><br />The Status Register holds flags with information about the last
        instruction. For example when doing a subtract you can check if the result was a zero.
        <br /><br /><br /><br /><font size="+1">6502 Instruction Set</font><br />
        These are just the most common and basic instructions. Most have a few different options which
        will be used later. There are also a few more complicated instructions to be covered later.<br /><br />
        <b>Common Load/Store opcodes</b><br />
        <pre>LDA #$0A   ; LoaD the value 0A into the accumulator A<br>           ; the number part of the opcode can be a value or an address<br>           ; if the value is zero, the zero flag will be set.<br><br>LDX $0000  ; LoaD the value at address $0000 into the index register X<br>           ; if the value is zero, the zero flag will be set.<br><br>LDY #$FF   ; LoaD the value $FF into the index register Y<br>           ; if the value is zero, the zero flag will be set.<br><br>STA $2000  ; STore the value from accumulator A into the address $2000<br>           ; the number part must be an address<br><br>STX $4016  ; STore value in X into $4016<br>           ; the number part must be an address<br><br>STY $0101  ; STore Y into $0101<br>           ; the number part must be an address<br><br>TAX        ; Transfer the value from A into X<br>           ; if the value is zero, the zero flag will be set<br><br>TAY        ; Transfer A into Y<br>           ; if the value is zero, the zero flag will be set<br><br>TXA        ; Transfer X into A<br>           ; if the value is zero, the zero flag will be set<br><br>TYA        ; Transfer Y into A<br>           ; if the value is zero, the zero flag will be set<br><br></pre>
        <br />
        <b>Common Math opcodes</b><br />
        <pre>ADC #$01   ; ADd with Carry<br>           ; A = A + $01 + carry<br>           ; if the result is zero, the zero flag will be set<br><br>SBC #$80   ; SuBtract with Carry<br>           ; A = A - $80 - (1 - carry)<br>           ; if the result is zero, the zero flag will be set<br><br>CLC        ; CLear Carry flag in status register<br>           ; usually this should be done before ADC<br><br>SEC        ; SEt Carry flag in status register<br>           ; usually this should be done before SBC<br><br>INC $0100  ; INCrement value at address $0100<br>           ; if the result is zero, the zero flag will be set<br><br>DEC $0001  ; DECrement $0001<br>           ; if the result is zero, the zero flag will be set<br><br>INY        ; INcrement Y register<br>           ; if the result is zero, the zero flag will be set<br><br>INX        ; INcrement X register<br>           ; if the result is zero, the zero flag will be set<br><br>DEY        ; DEcrement Y<br>           ; if the result is zero, the zero flag will be set<br><br>DEX        ; DEcrement X<br>           ; if the result is zero, the zero flag will be set<br><br>ASL A      ; Arithmetic Shift Left<br>           ; shift all bits one position to the left<br>           ; this is a multiply by 2<br>           ; if the result is zero, the zero flag will be set<br><br>LSR $6000  ; Logical Shift Right<br>           ; shift all bits one position to the right<br>           ; this is a divide by 2<br>           ; if the result is zero, the zero flag will be set<br></pre>
        <br />
        <b>Common Comparison opcodes</b><br />
        <pre>CMP #$01   ; CoMPare A to the value $01<br>           ; this actually does a subtract, but does not keep the result<br>           ; instead you check the status register to check for equal, <br>           ; less than, or greater than<br><br>CPX $0050  ; ComPare X to the value at address $0050<br><br>CPY #$FF   ; ComPare Y to the value $FF<br></pre>
        <br />
        <b>Common Control Flow opcodes</b><br />
        <pre>JMP $8000  ; JuMP to $8000, continue running code there<br><br>BEQ $FF00  ; Branch if EQual, contnue running code there<br>           ; first you would do a CMP, which clears or sets the zero flag<br>           ; then the BEQ will check the zero flag<br>           ; if zero is set (values were equal) the code jumps to $FF00 and runs there<br>           ; if zero is clear (values not equal) there is no jump, runs next instruction<br><br>BNE $FF00  ; Branch if Not Equal - opposite above, jump is made when zero flag is clear<br></pre>
        <br /><br />
        <font size="+2"> NES Code Structure</font><br />
        <b>Getting Started</b><br />
        This section has a lot of information because it will get everything set up to run your first NES
        program. Much of the code can be copy/pasted then ignored for now. The main goal is to just get
        NESASM to output something useful.<br /><br />
        <b>iNES Header</b><br />
        The 16 byte iNES header gives the emulator all the information about the game including mapper,
        graphics mirroring, and PRG/CHR sizes. You can include all this inside your asm file at the very
        beginning.<br />
        <pre>  .inesprg 1   ; 1x 16KB bank of PRG code<br>  .ineschr 1   ; 1x 8KB bank of CHR data<br>  .inesmap 0   ; mapper 0 = NROM, no bank swapping<br>  .inesmir 1   ; background mirroring (ignore for now)<br></pre>
        <br />
        <b>Banking</b><br />
        NESASM arranges everything in 8KB code and 8KB graphics banks. To fill the 16KB PRG space 2 banks
        are needed. Like most things in computing, the numbering starts at 0. For each bank you have to
        tell the assembler where in memory it will start.<br />
        <pre>  .bank 0<br>  .org $C000<br>;some code here<br><br>  .bank 1<br>  .org $E000<br>; more code here<br><br>  .bank 2<br>  .org $0000<br>; graphics here<br></pre>
        <br />
        <b>Adding Binary Files</b>
        Additional data files are frequently used for graphics data or level data. The incbin directive
        can be used to include that data in your .NES file. This data will not be used yet, but is needed
        to make the .NES file size match the iNES header.<br />
        <pre>  .bank 2<br>  .org $0000<br>  .incbin "mario.chr"   ;includes 8KB graphics file from SMB1<br></pre>
        <br /><br />
        <b>Vectors</b><br />
        There are three times when the NES processor will interrupt your code and jump to a new location.
        These vectors, held in PRG ROM tell the processor where to go when that happens. Only the first
        two will be used in this tutorial.<br /><br />
        <b>NMI Vector</b> - this happens once per video frame, when enabled. The PPU tells the processor
        it is starting the VBlank time and is available for graphics updates.<br />
        <b>RESET Vector</b> - this happens every time the NES starts up, or the reset button is
        pressed.<br />
        <b>IRQ Vector</b> - this is triggered from some mapper chips or audio interrupts and will not be
        covered.<br /><br />
        These three must always appear in your assembly file the right order. The .dw directive is used
        to define a Data Word (1 word = 2 bytes):<br />
        <pre>  .bank 1<br>  .org $FFFA     ;first of the three vectors starts here<br>  .dw NMI        ;when an NMI happens (once per frame if enabled) the <br>                   ;processor will jump to the label NMI:<br>  .dw RESET      ;when the processor first turns on or is reset, it will jump<br>                   ;to the label RESET:<br>  .dw 0          ;external interrupt IRQ is not used in this tutorial<br><br></pre>
        <br />
        <b>Reset Code</b><br />
        The reset vector was set to the label RESET, so when the processor starts up it will start from
        RESET: Using the .org directive that code is set to a space in game ROM. A couple modes are set
        right at the beginning. We are not using IRQs, so they are turned off. The NES 6502 processor
        does not have a decimal mode, so that is also turned off. This section does NOT include
        everything needed to run code on the real NES, but will work with the FCEUXD SP emulator. More
        reset code will be added later.<br />
        <pre>  .bank 0<br>  .org $C000<br>RESET:<br>  SEI        ; disable IRQs<br>  CLD        ; disable decimal mode<br></pre>
        <br />
        <b>Completing The Program</b><br />
        Your first program will be very exciting, displaying an entire screen of one color! To do this
        the first PPU settings need to be written. This is done to memory address $2001. The 76543210 is
        the bit number, from 7 to 0. Those 8 bits form the byte you will write to $2001.<br />
        <pre>PPUMASK ($2001)<br><br>76543210<br>||||||||<br>|||||||+- Grayscale (0: normal color; 1: AND all palette entries<br>|||||||   with 0x30, effectively producing a monochrome display;<br>|||||||   note that colour emphasis STILL works when this is on!)<br>||||||+-- Disable background clipping in leftmost 8 pixels of screen<br>|||||+--- Disable sprite clipping in leftmost 8 pixels of screen<br>||||+---- Enable background rendering<br>|||+----- Enable sprite rendering<br>||+------ Intensify reds (and darken other colors)<br>|+------- Intensify greens (and darken other colors)<br>+-------- Intensify blues (and darken other colors)<br></pre>
        <br />
        So if you want to enable the sprites, you set bit 3 to 1. For this program bits 7, 6, 5 will be
        used to set the screen color:<br />
        <pre>  LDA %10000000   ;intensify blues<br>  STA $2001<br>Forever:<br>  JMP Forever     ;infinite loop<br></pre>
        <br />
        <b>Putting It All Together</b><br />
        Download and unzip the
        <a
          href="scraper/files/background.zip"
          target="_blank"
          original-href="http://www.nespowerpak.com/nesasm/background.zip"
          >background.zip</a
        >
        sample files. All the code above is in the background.asm file. Make sure that file, mario.chr,
        and background.bat is in the same folder as
        <a
          href="scraper/files/NESASM3.zip"
          target="_blank"
          original-href="http://www.nespowerpak.com/nesasm/NESASM3.zip"
          >NESASM3</a
        >, then double click on background.bat. That will run NESASM3 and should produce background.nes.
        Run that NES file in
        <a
          href="http://www.the-interweb.com/serendipity/exit.php?url_id=627_id=90"
          target="_blank"
          original-href="http://www.the-interweb.com/serendipity/exit.php?url_id=627_id=90"
          >FCEUXD SP</a
        >
        to see your background color! Edit background.asm to change the intensity bits 7-5 to make the
        background red or green.<br /><br />
        You can start the Debug... from the Tools menu in
        <a
          href="http://www.the-interweb.com/serendipity/exit.php?url_id=627&amp;entry_id=90"
          target="_blank"
          original-href="http://www.the-interweb.com/serendipity/exit.php?url_id=627&amp;entry_id=90"
          >FCEUXD SP</a
        >
        to watch your code run. Hit the Step Into button, choose Reset from the NES menu, then keep
        hitting Step Into to run one instruction at a time. On the left is the memory address, next is
        the hex opcode that the 6502 is actually running. This will be between one and three bytes. After
        that is the code you wrote, with the comments taken out and labels translated to addresses. The
        top line is the instruction that is going to run next. So far there isn't much code, but the
        debugger will be very helpful later.
        <br /><br /><br />
        <b>NEXT WEEK:</b> more PPU details, start of graphics
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-3__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4440"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-4">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 4: Color Palettes, Sprites, second app</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <a
          href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4440&amp;enterthread=y"
          target="_blank"
          original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=4440&amp;enterthread=y"
          >Previous Week</a
        >
        - 6502 ASM
        <div>
          <div><br class="webkit-block-placeholder" /></div>
          <div>
            <span class="Apple-style-span" style="font-weight: bold">This Week</span>: now that you can
            make and run a program, time to put something on screen!
          </div>
          <div><br class="webkit-block-placeholder" /></div>
          <div>
            <span class="Apple-style-span" style="font-weight: bold"
              ><span class="Apple-style-span" style="font-size: large">Palettes</span></span
            ><span class="Apple-style-span" style="font-size: large">&nbsp;</span>
          </div>
          <div><br class="webkit-block-placeholder" /></div>
          <div>
            Before putting any graphics on screen, you first need to set the color palette. There are two
            separate palettes, each 16 bytes. One palette is used for the background, and the other for
            sprites. The byte in the palette corresponds to one of the 64 base colors the NES can
            display. $0D is a bad color and should not be used. These colors are not exact and will look
            different on emulators and TVs.
          </div>
          <div align="baseline"><br /></div>
          <div>
            <img
              src="img/4924FAF3-9FC9-CED2-8403873F9EA75342.png"
              original-src="http://www.NintendoAgeMedia.com/users/142/photobucket/4924FAF3-9FC9-CED2-8403873F9EA75342.png"
              show-src="img/4924FAF3-9FC9-CED2-8403873F9EA75342.png"
            /><br class="webkit-block-placeholder" />
          </div>
          <div><br class="webkit-block-placeholder" /></div>
          <div>
            The palettes start at PPU address $3F00 and $3F10. To set this address, PPU address port
            $2006 is used. This port must be written twice, once for the high byte then for the low byte:
          </div>
          <div>
            <pre>  LDA $2002    ; read PPU status to reset the high/low latch to high<br>  LDA #$3F<br>  STA $2006    ; write the high byte of $3F10 address<br>  LDA #$10<br>  STA $2006    ; write the low byte of $3F10 address</pre>
          </div>
          <div>
            That code tells the PPU to set its address to $3F10. Now the PPU data port at $2007 is ready
            to accept data. The first write will go to the address you set ($3F10), then the PPU will
            automatically increment the address ($3F11, $3F12, $3F13) after each read or write. You can
            keep writing data and it will keep incrementing. This sets the first 4 colors in the palette:
            <pre>  LDA #$32   ;code for light blueish<br>  STA $2007  ;write to PPU $3F10<br>  LDA #$14   ;code for pinkish<br>  STA $2007  ;write to PPU $3F11<br>  LDA #$2A   ;code for greenish<br>  STA $2007  ;write to PPU $3F12<br>  LDA #$16   ;code for redish<br>  STA $2007  ;write to PPU $3F13<br></pre>
            You would continue to do writes to fill out the rest of the palette. Fortunately there is a
            smaller way to write all that code. First you can use the .db directive to store data bytes:
            <pre>PaletteData:<br>  .db $0F,$31,$32,$33,$0F,$35,$36,$37,$0F,$39,$3A,$3B,$0F,$3D,$3E,$0F  ;background palette data<br>  .db $0F,$1C,$15,$14,$0F,$02,$38,$3C,$0F,$1C,$15,$14,$0F,$02,$38,$3C  ;sprite palette data<br></pre>
            Then a loop is used to copy those bytes to the palette in the PPU. The X register is used as
            an index into the palette, and used to count how many times the loop has repeated. You want
            to copy both palettes at once which is 32 bytes, so the loop starts at 0 and counts up to 32.
            <pre>  LDX #$00                ; start out at 0<br>LoadPalettesLoop:<br>  LDA PaletteData, x      ; load data from address (PaletteData + the value in x)<br>                          ; 1st time through loop it will load PaletteData+0<br>                          ; 2nd time through loop it will load PaletteData+1<br>                          ; 3rd time through loop it will load PaletteData+2<br>                          ; etc<br>  STA $2007               ; write to PPU<br>  INX                     ; X = X + 1<br>  CPX #$20                ; Compare X to hex $20, decimal 32<br>  BNE LoadPalettesLoop    ; Branch to LoadPalettesLoop if compare was Not Equal to zero<br>                          ; if compare was equal to 32, keep going down</pre>
            <br /><br /><br class="webkit-block-placeholder" />Once that code finishes, the full color
            palette is ready. One byte or the whole thing can be changed while your program is running.
          </div>
          <div><br class="webkit-block-placeholder" /></div>
          <div><br /></div>
        </div>
        <span class="Apple-style-span" style="font-weight: bold"
          ><span class="Apple-style-span" style="font-size: large"> Sprites</span></span
        >
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          Anything that moves separately from the background will be made of sprites. A sprite is just an
          8x8 pixel tile that the PPU renders anywhere on the screen. Generally objects are made from
          multiple sprites next to each other. Examples would be Mario and any of the enemies like
          Goombas and Bowser. The PPU has enough internal memory for 64 sprites. This memory is separate
          from all other video memory and cannot be expanded.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div><span class="Apple-style-span" style="font-weight: bold">Sprite DMA </span></div>
        <div>
          The fastest and easiest way to transfer your sprites to the sprite memory is using DMA (direct
          memory access). This just means a block of RAM is copied from CPU memory to the PPU sprite
          memory. The on board RAM space from $0200-02FF is usually used for this purpose. To start the
          transfer, two bytes need to be written to the PPU ports:
          <pre>  LDA #$00<br>  STA $2003  ; set the low byte (00) of the RAM address<br>  LDA #$02<br>  STA $4014  ; set the high byte (02) of the RAM address, start the transfer<br></pre>
          Once the second write is done the DMA transfer will start automatically. All data for the 64
          sprites will be copied. Like all graphics updates, this needs to be done at the beginning of
          the VBlank period, so it will go in the NMI section of your code.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div><span class="Apple-style-span" style="font-weight: bold">Sprite Data</span></div>
        <div>Each sprite needs 4 bytes of data for its position and tile information in this order:</div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          1 - Y Position - vertical position of the sprite on screen. $00 is the top of the screen.
          Anything above $EF is off the bottom of the screen.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          2 - Tile Number - this is the tile number (0 to 256) for the graphic to be taken from a Pattern
          Table.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          3 - Attributes - this byte holds color and displaying information:
          <pre>  76543210<br>  |||   ||<br>  |||   ++- Color Palette of sprite.  Choose which set of 4 from the 16 colors to use<br>  |||<br>  ||+------ Priority (0: in front of background; 1: behind background)<br>  |+------- Flip sprite horizontally<br>  +-------- Flip sprite vertically<br></pre>
          4 - X Position - horizontal position on the screen. $00 is the left side, anything above $F9 is
          off screen.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          Those 4 bytes repeat 64 times (one set per sprite) to fill the 256 bytes of sprite memory. If
          you want to edit sprite 0, you change bytes $0200-0203. Sprite 1 is $0204-0207, sprite 2 is
          $0208-020B, etc
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div><span class="Apple-style-span" style="font-weight: bold">Turning NMI/Sprites On</span></div>
        <div>
          The PPU port $2001 is used again to enable sprites. Setting bit 4 to 1 will make them appear.
          NMI also needs to be turned on, so the Sprite DMA will run and the sprites will be copied every
          frame. This is done with the PPU port $2000. The Pattern Table 0 is also selected to choose
          sprites from. Background will come from Pattern Table 1 when that is added later.
          <pre>  PPUCTRL ($2000)<br>  76543210<br>  | ||||||<br>  | ||||++- Base nametable address<br>  | ||||    (0 = $2000; 1 = $2400; 2 = $2800; 3 = $2C00)<br>  | |||+--- VRAM address increment per CPU read/write of PPUDATA<br>  | |||     (0: increment by 1, going across; 1: increment by 32, going down)<br>  | ||+---- Sprite pattern table address for 8x8 sprites (0: $0000; 1: $1000)<br>  | |+----- Background pattern table address (0: $0000; 1: $1000)<br>  | +------ Sprite size (0: 8x8; 1: 8x16)<br>  |<br>  +-------- Generate an NMI at the start of the<br>            vertical blanking interval vblank (0: off; 1: on)<br></pre>
          And the new code to set up the sprite data:
          <pre>  LDA #$80<br>  STA $0200        ;put sprite 0 in center ($80) of screen vertically<br>  STA $0203        ;put sprite 0 in center ($80) of screen horizontally<br>  LDA #$00<br>  STA $0201        ;tile number = 0<br>  STA $0202        ;color palette = 0, no flipping<br><br>  LDA #%10000000   ; enable NMI, sprites from Pattern Table 0<br>  STA $2000<br><br>  LDA #%00010000   ; no intensify (black background), enable sprites<br>  STA $2001</pre>
          <span class="Apple-style-span" style="font-weight: bold"
            ><div style="text-align: left">Putting It All Together <br /></div
          ></span>
        </div>
        <div style="text-align: left">
          Download and unzip the
          <a
            href="scraper/files/sprites.zip"
            target="_blank"
            original-href="http://www.nespowerpak.com/nesasm/sprites.zip"
            >sprites.zip</a
          >
          sample files. All the code above is in the sprites.asm file. Make sure sprites.asm, mario.chr,
          and sprites.bat are all in the same folder as NESASM3, then double click sprites.bat. That will
          run NESASM3 and should produce the sprites.nes file. Run that NES file in FCEUXD SP to see your
          sprite! Tile number 0 is the back of Mario's head and hat, can you see it? Edit sprites.asm to
          change the sprite position (0 to 255), or to change the color palette for the sprite (0 to 3).
          You can choose the PPU viewer in FCEUXD SP to see both Pattern Tables, and both Palettes.
        </div>
        <div style="text-align: left"><br class="webkit-block-placeholder" /></div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold">Next Week</span>: multiple sprites,
          reading controllers
        </div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-4__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=6082"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-5">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">
          Nerdy Nights week 5: multiple sprites, reading controllers, more instructions
        </h2>
      </div>
      <div class="mdl-card__supporting-text">
        <a
          href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=6082"
          target="_blank"
          original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=6082"
          >Previous Week</a
        >
        - Palettes, Sprites<br /><br />
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold">This Week</span>: &nbsp;one sprite is
          boring, so now we add many more! &nbsp;Also move that sprite around using the controller.
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: large">Multiple Sprites</span></span
          >
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          Last time there was only 1 sprite loaded so we just used a few LDA/STA pairs to load the sprite
          data. &nbsp;This time we will have 4 sprites on screen. &nbsp;Doing that many load/stores just
          takes too much writing and code space. &nbsp;Instead a loop will be used to load the data, like
          was used to load the palette before. &nbsp;First the data bytes are set up using the .db
          directive:
        </div>
        <div><br class="webkit-block-placeholder" /></div>
        <div>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">sprites:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;&nbsp; &nbsp; ;vert tile attr horiz</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; .db $80, $32, $00, $80 &nbsp; ;sprite 0</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; .db $80, $33, $00, $88 &nbsp; ;sprite 1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; .db $88, $34, $00, $80 &nbsp; ;sprite 2</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; .db $88, $35, $00, $88 &nbsp; ;sprite 3</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <br class="webkit-block-placeholder" />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          ></p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >There are 4 bytes per sprite, each on one line.&nbsp; The bytes are in the correct order
              and easily changed.&nbsp; &nbsp; This is only the starting data, when the program is
              running the copy in RAM can be changed to move the sprite around.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Next you need the loop to copy the data into RAM.&nbsp; This loop also works the same way
              as the palette loading, with the X register as the loop counter.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">LoadSprites:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; LDX #$00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; start at 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">LoadSpritesLoop:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; LDA sprites, x&nbsp; &nbsp; &nbsp; &nbsp; ; load data from address (sprites +
              x)</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; STA $0200, x&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; store into RAM address ($0200 +
              x)</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; INX &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; X = X +
              1</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; CPX #$10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Compare X to hex $10,
              decimal 16</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; BNE LoadSpritesLoop &nbsp; ; Branch to LoadSpritesLoop if compare was Not Equal to
              zero</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; if
              compare was equal to 16, continue down</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >If you wanted to add more sprites, you would add lines into the sprite .db section then
              increase the CPX compare value.&nbsp; That will run the loop more times, copying more
              bytes.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            Once the&nbsp;sprites have been loaded into RAM, you can modify the data there. &nbsp;
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <br class="webkit-block-placeholder" />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          ></p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              font-family: sans-serif;
              font-size: 12px;
            "
          >
            <br class="webkit-block-placeholder" />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              font-family: sans-serif;
              font-size: 12px;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              font-family: sans-serif;
              font-size: 12px;
            "
          ></p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>Controller Ports</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The controllers are accessed through memory port addresses $4016 and $4017.&nbsp; First
              you have to write the value $01 then the value $00 to port $4016.&nbsp; This tells the
              controllers to latch the current button positions.&nbsp; Then you read from $4016 for first
              player or $4017 for second player.&nbsp; The buttons are sent&nbsp; one at a time, in bit
              0.&nbsp; If bit 0 is 0, the button is not pressed.&nbsp; If bit 0 is 1, the button is
              pressed.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Button status for each controller is returned in the following order: A, B, Select, Start,
              Up, Down, Left, Right.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$01</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $4016</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$00</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; STA $4016 &nbsp; &nbsp; ; tell both the controllers to latch buttons</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - A</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - B</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Select</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Start</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Up</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Down</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Left</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; ; player 1 - Right</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - A</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - B</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Select</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Start</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Up</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Down</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Left</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4017 &nbsp; &nbsp; ; player 2 - Right</span>
          </p>
          <div>
            <span class="Apple-style-span" style="font-family: Monaco; font-size: 10px"
              ><br class="webkit-block-placeholder"
            /></span>
          </div>
          <p></p>
          <p></p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          ></p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>AND Instruction</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Button information is only sent in bit 0, so we want to erase all the other bits.&nbsp;
              This can be done with the AND instruction.&nbsp; Each of the 8 bits is ANDed with the bits
              from another value.&nbsp; If the bit from both the first AND second value is 1, then the
              result is 1.&nbsp; Otherwise the result is 0.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">0 AND 0 = 0</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">0 AND 1 = 0</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">1 AND 0 = 0</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">1 AND 1 = 1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px">For a full random 8 bit value:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; 01011011</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">AND &nbsp; 10101101</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">--------------</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; 00001001</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >We only want bit 0, so that bit is set and the others are cleared:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; 01011011&nbsp; &nbsp; controller data</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">AND &nbsp; 00000001&nbsp; &nbsp; AND value</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">--------------</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; 00000001&nbsp; &nbsp; only bit 0 is used, everything else
              erased</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >So to erase all the other bits when reading controllers, the AND should come after each
              read from $4016 or $4017:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; &nbsp; ; player 1 - A</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; AND #%00000001</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; &nbsp; ; player 1 - B</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; AND #%00000001</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; LDA $4016 &nbsp; &nbsp; &nbsp; ; player 1 - Select</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; AND #%00000001</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>BEQ instruction</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The BNE instruction was used earlier in loops to Branch when Not Equal to a compared
              value.&nbsp; Here BEQ will be used without the compare instruction to Branch when EQual to
              zero.&nbsp; When a button is not pressed, the value will be zero, so the branch is
              taken.&nbsp; That skips over all the instructions that do something when the button is
              pressed:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">ReadA:&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016 &nbsp; &nbsp; &nbsp; ; player 1 - A</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; AND #%00000001&nbsp; ; erase everything but bit 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; BEQ ReadADone &nbsp; ; branch to ReadADone if button is NOT pressed (0)</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; add instructions here to
              do something when button IS pressed (1)</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >ReadADone:&nbsp; &nbsp; &nbsp; &nbsp; ; handling this button is done</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>CLC/ADC instructions</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >For this demo we will use the player 1 controller to move the Mario sprite around.&nbsp;
              To do that we need to be able to add to values.&nbsp; The ADC instruction stands for Add
              with Carry.&nbsp; Before adding, you have to make sure the carry is cleared, using
              CLC.&nbsp; This sample will load the sprite position into A, clear the carry, add one to
              the value, then store back into the sprite position:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; LDA $0203 &nbsp; ; load sprite X (horizontal) position</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; CLC &nbsp; &nbsp; &nbsp; &nbsp; ; make sure the carry flag is clear</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; ADC #$01&nbsp; &nbsp; ; A = A + 1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; STA $0203 &nbsp; ; save sprite X (horizontal) position</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>SEC/SBC instructions</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >To move the sprite the other direction, a subtract is needed.&nbsp; SBC is Subtract with
              Carry.&nbsp; This time the carry has to be set before doing the subtract:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $0203 &nbsp; ; load sprite position</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; SEC &nbsp; &nbsp; &nbsp; &nbsp; ; make sure carry flag is set</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; SBC #$01&nbsp; &nbsp; ; A = A - 1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $0203 &nbsp; ; save sprite position</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 18px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"><b>Putting It All Together</b></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Download and unzip the
              <a
                href="scraper/files/controller.zip"
                target="_blank"
                original-href="http://www.nespowerpak.com/nesasm/controller.zip"
                >controller.zip</a
              >&nbsp;</span
            ><span style="letter-spacing: 0px"
              >sample files.&nbsp; All the code above is in the controller.asm file.&nbsp; Make sure that
              file, mario.chr, and controller.bat is in the same folder as NESASM, then double click on
              controller.bat.&nbsp; That will run NESASM and should produce controller.nes.&nbsp; Run
              that NES file in FCEUXD SP to see small Mario.&nbsp; Press the A and B buttons on the
              player 1 controller to move one sprite of Mario.&nbsp; The movement will be one pixel per
              frame, or 60 pixels per second on NTSC machines.&nbsp; If Mario isn't moving, make sure
              your controls are set up correctly in the Config menu under Input...&nbsp; If you hold both
              buttons together, the value will be added then subtracted so no movement will happen.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Try editing the ADC and SBC values to make him move faster.&nbsp; The screen is only 256
              pixels across, so too fast and he will just jump around randomly!&nbsp; Also try editing
              the code to move all 4 sprites together.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            Finally try changing the code to use the dpad instead of the A and B buttons.
            &nbsp;Left/right should change the X position of the sprites, and up/down should change the Y
            position of the sprites.
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <br class="webkit-block-placeholder" />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span class="Apple-style-span" style="font-weight: bold">NEXT WEEK</span>: &nbsp;Backgrounds,
            attribute table
          </p>
          <div><br class="webkit-block-placeholder" /></div>
          <p></p>
          <p></p>
        </div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-5__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=7974"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-6">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 6: Backgrounds</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <a
          href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=7974"
          target="_blank"
          original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=7974"
          >Previous Week</a
        >
        - Multiple sprites, reading controllers
        <div><br /></div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold">This Week: &nbsp;</span>Now that you
          have a basic understanding of the NES tile graphics, we learn how to display one static non
          scrolling background. &nbsp;
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: x-large"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: x-large">Backgrounds</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >There are three components used to generate backgrounds on the NES. &nbsp;First is the
            background color palette, used to select the colors that will be used on screen. &nbsp;Next
            is the nametable that tells the layout of the graphics. &nbsp;Finally is the attribute table
            that assigns the colors in the palette to areas on screen.</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 18px; font-weight: bold"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: medium">Background Palette</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >Like the sprites there are 16 colors in the
            <span class="Apple-style-span" style="font-weight: bold">background palette</span>. &nbsp;Our
            previous apps were already loading a background palette but it was not being used yet.
            &nbsp;You can use the PPU Viewer in FCEUXD SP to see the color palettes. &nbsp;</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 16px; font-weight: bold"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: medium">Nametables</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small">L</span
          ><span class="Apple-style-span" style="font-size: small"
            >ike the sprites, background images are made up from 8x8 pixel tiles. &nbsp;The screen video
            resolution is 32x30 tiles, or 256x240 pixels. &nbsp;PAL systems will show this full
            resolution but NTSC crops the top 8 and bottom 8 rows of pixels for a final resolution of
            256x224. &nbsp;Additionally TV's on either system can crop another few rows on the top or
            bottom.</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >One screen full of background tiles is called a
            <span class="Apple-style-span" style="font-weight: bold">nametable</span>, and the NES has
            enough internal RAM connected to the PPU for two nametables. &nbsp;Only one will be used
            here. &nbsp;The nametable has one byte (0-255) for which 8x8 pixel graphics tile to draw on
            screen. &nbsp;The nametable we will use starts at PPU address $2000 and takes up 960 bytes
            (32x30). &nbsp;You can use the Nametable viewer in FCEUXD SP to see all the nametables.
            &nbsp;</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: medium">Attribute Tables</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >The attribute tables may be the most difficult thing to understand, and sets many of the
            graphics limitations. &nbsp;Each nametable has an
            <span class="Apple-style-span" style="font-weight: bold">attribute table</span> that sets
            which colors in the palette will be used in sections of the screen. &nbsp;The attribute table
            is stored in the same internal RAM as the nametable, and we will use the one that starts at
            PPU address $23C0 ($2000+960). &nbsp;</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >First the screen is divided into a 32x32 pixel grid, or 4x4 tiles. &nbsp;Each byte in the
            attribute table sets the color group&nbsp;(0-3)&nbsp;in the background palette that will be
            used in that area. &nbsp;That 4x4 tile area is divided again into 4 2x2 tile grids. &nbsp;Two
            bits of the attribute table byte are assigned to each 2x2 area. &nbsp;That is the size of one
            block in SMB. &nbsp;This limitation means that only 4 colors (one color group) can be used in
            any 16x16 pixel background section. &nbsp;A green SMB pipe section cannot use the color red
            because it already uses 4 colors.</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div align="baseline">
          <span class="Apple-style-span" style="font-size: 13px"
            >When looking at a sample SMB screen, first the 4x4 tile grid is added and the palette is
            shown at the bottom:</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><img
              src="img/F837623F-9C98-E50B-F4D377EE82FA2BDA.png"
              original-src="http://www.NintendoAgeMedia.com/users/142/photobucket/F837623F-9C98-E50B-F4D377EE82FA2BDA.png"
              show-src="img/F837623F-9C98-E50B-F4D377EE82FA2BDA.png"
          /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 16px; font-weight: bold"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >You can see there are 8 grid squares horizontally, so there will be 8 attribute bytes
            horizontally. &nbsp;Then each one of those grid squares is split up into 2x2 tile sections to
            generate the attribute byte:</span
          >
        </div>
        <div align="baseline">
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><img
              src="img/F8376193-9343-AF0D-B8DA7BD8B7DD9301.png"
              original-src="http://www.NintendoAgeMedia.com/users/142/photobucket/F8376193-9343-AF0D-B8DA7BD8B7DD9301.png"
              show-src="img/F8376193-9343-AF0D-B8DA7BD8B7DD9301.png"
          /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >No 16x16 area can use more than 4 colors, so the question mark and the block cannot use the
            greens from the palette.</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: medium">Uploading the data</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: small"
            >To set the background graphics your data has to be defined in your ROM using the .db
            directive, then copied to the PPU RAM. &nbsp;Some graphics tools will generate this data but
            here it will just be done manually. &nbsp;To keep it shorter only a few rows of graphics will
            be created. &nbsp;The same CHR file from SMB will be used here too. &nbsp;First the nametable
            data is defined, with each graphics row split into two 16 byte sections to keep lines
            shorter:</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              nametable:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24&nbsp; ;;row 1
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24&nbsp; ;;all sky
              ($24 = sky)
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                min-height: 14px;
              "
            >
              <br />
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24&nbsp; ;;row 2
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24&nbsp; ;;all sky
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                min-height: 14px;
              "
            >
              <br />
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$45,$45,$24,$24,$45,$45,$45,$45,$45,$45,$24,$24&nbsp; ;;row 3
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$53,$54,$24,$24&nbsp; ;;some
              brick tops
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                min-height: 14px;
              "
            >
              <br />
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$47,$47,$24,$24,$47,$47,$47,$47,$47,$47,$24,$24&nbsp; ;;row 4
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$24,$55,$56,$24,$24&nbsp; ;;brick
              bottoms
            </p></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><span class="Apple-style-span" style="font-size: 12px"
              ><div>
                <span class="Apple-style-span" style="font-size: 13px"><br /></span>
              </div>
              <div>
                <span class="Apple-style-span" style="font-size: 13px"
                  >Then the attribute table data is defined. &nbsp;Each byte covers 4x4 tiles, so only 8
                  bytes are needed here. &nbsp;Binary is used so editing the 2 bits per 2x2 tile area is
                  easier:</span
                >
              </div>
              <div>
                <span class="Apple-style-span" style="font-size: 13px"><br /></span>
              </div>
              <div>
                <span class="Apple-style-span" style="font-size: 13px"
                  ><p
                    style="
                      margin-top: 0px;
                      margin-right: 0px;
                      margin-bottom: 0px;
                      margin-left: 0px;
                      font: normal normal normal 10px / normal Monaco;
                    "
                  >
                    attribute:
                  </p>
                  <p
                    style="
                      margin-top: 0px;
                      margin-right: 0px;
                      margin-bottom: 0px;
                      margin-left: 0px;
                      font: normal normal normal 10px / normal Monaco;
                    "
                  >
                    &nbsp; .db %00000000, %00010000, %01010000, %00010000, %00000000, %00000000,
                    %00000000, %00110000
                  </p></span
                >
              </div>
              <div>
                <span class="Apple-style-span" style="font-size: 13px"><br /></span></div></span
          ></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >And finally the same color palette as SMB is used:</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              palette:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; .db $22,$29,$1A,$0F,&nbsp; $22,$36,$17,$0F,&nbsp; $22,$30,$21,$0F,&nbsp;
              $22,$27,$17,$0F
            </p></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >Just like our previous palette loading, a loop is used to copy a specific number of bytes
            from a memory location to the PPU. &nbsp;First the PPU address is set to the beginning of the
            nametable at $2000. &nbsp;Then our 128 bytes of background data are copied. &nbsp;Next the
            PPU address is set to the beginning of the attribute table at $23C0 and 8 bytes are
            copied.</span
          >
        </div>
        <div><br /></div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              LoadBackground:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDA $</span
              ><span style="color: rgb(28, 0, 207)">2002</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>; read
              PPU status to reset the high/low latch
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; LDA <span style="color: rgb(0, 116, 0)">#$20</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; STA $</span
              ><span style="color: rgb(28, 0, 207)">2006</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>;
              write the high byte of $2000 address
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; LDA <span style="color: rgb(0, 116, 0)">#$00</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; STA $</span
              ><span style="color: rgb(28, 0, 207)">2006</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>;
              write the low byte of $2000 address
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDX </span>#$00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; ; start out at 0
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              LoadBackgroundLoop:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDA background, x &nbsp; &nbsp; </span>; load data
              from address (background + the value in x)
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $<span style="color: rgb(28, 0, 207)">2007</span> &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; <span style="color: rgb(0, 116, 0)">; write to PPU</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; INX &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              <span style="color: rgb(0, 116, 0)">; X = X + 1</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; CPX </span>#$80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; ; Compare X to hex $80, decimal 128 - copying 128 bytes
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; BNE LoadBackgroundLoop&nbsp; </span>; Branch to
              LoadBackgroundLoop if compare was Not Equal to zero
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)"
                >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span
              >; if compare was equal to 128, keep going down
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                min-height: 14px;
              "
            >
              &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              LoadAttribute:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDA $</span
              ><span style="color: rgb(28, 0, 207)">2002</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>; read
              PPU status to reset the high/low latch
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; LDA <span style="color: rgb(0, 116, 0)">#$23</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; STA $</span
              ><span style="color: rgb(28, 0, 207)">2006</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>;
              write the high byte of $23C0 address
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; LDA <span style="color: rgb(0, 116, 0)">#$C0</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; STA $</span
              ><span style="color: rgb(28, 0, 207)">2006</span
              ><span style="color: rgb(0, 0, 0)"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>;
              write the low byte of $23C0 address
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDX </span>#$00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; ; start out at 0
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              LoadAttributeLoop:
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; LDA attribute, x&nbsp; &nbsp; &nbsp; </span>; load
              data from address (attribute + the value in x)
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $<span style="color: rgb(28, 0, 207)">2007</span> &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; <span style="color: rgb(0, 116, 0)">; write to PPU</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; INX &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              <span style="color: rgb(0, 116, 0)">; X = X + 1</span>
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
                color: rgb(0, 116, 0);
              "
            >
              <span style="color: rgb(0, 0, 0)">&nbsp; CPX </span>#$08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; ; Compare X to hex $08, decimal 8 - copying 8 bytes
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; BNE LoadAttributeLoop
            </p>
            <div><br /></div
          ></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >The final changes are to tell the PPU to use the Pattern Table 0 graphics for sprites, and
            Pattern Table 1 for background:</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp;&nbsp;LDA #%10010000 ;enable NMI, sprites from Pattern 0, background from Pattern 1
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $2000
            </p></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px">Enable the background rendering:</span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp;&nbsp;LDA #%00011110 ; enable sprites, enable background
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $2001
            </p></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            >And to tell the PPU that we are not doing any scrolling at the end of NMI:</span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp;&nbsp;LDA #$00
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $2005
            </p>
            <p
              style="
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font: normal normal normal 10px / normal Monaco;
              "
            >
              &nbsp; STA $2005
            </p></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 13px"
            ><div>
              <span
                class="Apple-style-span"
                style="color: rgb(28, 0, 207); font-family: Monaco; font-size: 10px"
                ><br
              /></span></div
          ></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold"
            ><span class="Apple-style-span" style="font-size: large">Putting It All Together</span></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 18px; font-weight: bold"
            ><span
              class="Apple-style-span"
              style="font-family: Helvetica; font-size: 12px; font-weight: normal"
              ><span style="letter-spacing: 0px"
                >Download and unzip the
                <a
                  href="scraper/files/background2.zip"
                  target="_blank"
                  original-href="http://www.nespowerpak.com/nesasm/background2.zip"
                  >background2.zip</a
                >&nbsp;</span
              ><span style="letter-spacing: 0px"
                >sample files.&nbsp; All the code above is in the background.asm file.&nbsp; Make sure
                that file, mario.chr, and background.bat is in the same folder as NESASM, then double
                click on background.bat.&nbsp; That will run NESASM and should produce
                background.nes.&nbsp; Run that NES file in FCEUXD SP to see the background. &nbsp;Set it
                to PAL Emulation so you get to see the whole screen.</span
              ></span
            ></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-family: Helvetica"><br /></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-size: 18px; font-weight: bold"
            ><span
              class="Apple-style-span"
              style="font-family: Helvetica; font-size: 12px; font-weight: normal"
              ><span style="letter-spacing: 0px"
                >Any background areas that you did not write to will still be using tile 0, which happens
                to be the number 0 in the SMB graphics. &nbsp;Try adding more nametable and attribute
                data to the .db sections, then changing the loops so they copy more bytes to the PPU RAM.
                &nbsp;You can also try changing the starting PPU address of the nametable and attribute
                table writes to move the rows further down.</span
              ></span
            ></span
          >
        </div>
        <div>
          <span class="Apple-style-span" style="font-family: Helvetica"
            ><span class="Apple-style-span" style="font-size: small"><br /></span
          ></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-family: Helvetica"
            ><span class="Apple-style-span" style="font-size: small"><br /></span
          ></span>
        </div>
        <div>
          <span class="Apple-style-span" style="font-family: Helvetica"
            ><span class="Apple-style-span" style="font-weight: bold"
              ><span class="Apple-style-span" style="font-size: small">NEXT WEEK</span></span
            ><span class="Apple-style-span" style="font-size: small"
              >: &nbsp;Subroutines, game structure, states</span
            ></span
          >
        </div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-6__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=8172"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-7">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">
          Nerdy Nights week 7: subroutines, game layout, starting Pong
        </h2>
      </div>
      <div class="mdl-card__supporting-text">
        <a
          href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=8172"
          target="_blank"
          original-href="http://www.nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=8172"
          >Previous Week</a
        >
        - Backgrounds
        <div><br /></div>
        <div>
          <span class="Apple-style-span" style="font-weight: bold">This Week:</span> &nbsp;Most of this
          lesson is about how to organize and structure your game. &nbsp;Subroutines and game states help
          arrange the code for easier reading and reuse of code. &nbsp;
        </div>
        <div><br /></div>
        <div><br /></div>
        <div>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              ><b><span class="Apple-style-span" style="font-size: medium">Variables</span></b></span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >As covered in week 1, variables are data stored in RAM that you can change any time.&nbsp;
              The sprite data in RAM is all variables.&nbsp; You will need more variables for keeping
              track of things like the score in the game.&nbsp; To do that you first need to tell NESASM
              where in RAM to put the variable.&nbsp; This is done using the .rsset and .rs
              directives.&nbsp; First .rsset is used to set the starting address of the variable.&nbsp;
              Then .rs is used to reserve space.&nbsp; Usually just 1 byte is reserved, but you can have
              as much as you want.&nbsp; Each time you do a .rs the address gets incremented so you don't
              need to do .rsset again.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; .rsset $0000&nbsp; &nbsp; ;put variables starting at 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; score1 &nbsp; .rs 1&nbsp; ;put score for player 1 at $0000</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; score2 &nbsp; .rs 1&nbsp; ;put score for player 2 at $0001</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; buttons1 .rs 1&nbsp; ;put controller data for player 1 at $0002</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; buttons2 .rs 1&nbsp; ;put controller data for player 2 at $0003</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Once you set the address for the variable, you do not need to know the address
              anymore.&nbsp; You can just reference it using the variable name you created.&nbsp; You can
              insert more variables above the current ones and the assembler will automatically
              recalculate the addresses.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <span class="Apple-style-span" style="font-size: 16px; font-weight: bold">Constants</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <span class="Apple-style-span" style="font-size: 16px; font-weight: bold"
              ><span class="Apple-style-span" style="font-size: 12px; font-weight: normal"
                >Constants are numbers that you do not change.&nbsp; They are just used to make your code
                easier to read.&nbsp; In Pong an example of a constant would be the position of the outer
                walls.&nbsp; You will need to compare the ball position to the walls to make the ball
                bounce, but the walls do not change so they are good constants.&nbsp; Doing a compare to
                LEFTWALL is easier to read and understand than a comparison to $F6.</span
              ></span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px">To declare constants you use the = sign:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              color: rgb(0, 116, 0);
            "
          >
            <span>&nbsp; RIGHTWALL&nbsp; &nbsp; &nbsp; = $</span><span>02</span><span>&nbsp;</span
            ><span style="letter-spacing: 0px">; when ball reaches one of these, do something</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; TOPWALL&nbsp; &nbsp; &nbsp; &nbsp; = $</span
            ><span>20</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BOTTOMWALL &nbsp; &nbsp; = $D8</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LEFTWALL &nbsp; &nbsp; &nbsp; = $F6</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The assembler will then do a find/replace when building your code.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <br /><span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              ><b><span class="Apple-style-span" style="font-size: medium">Subroutines</span></b></span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >As your program gets larger, you will want subroutines for organization and to reuse
              code.&nbsp; Instead of progressing linearly down your code, a subroutine is a block of code
              located somewhere else that you jump to, then return from.&nbsp; The subroutine can be
              called at any time, and used as many times as you want.&nbsp; Here is what some code looks
              like without subroutines:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">RESET:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; SEI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable IRQs</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; CLD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable decimal mode</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >vblankwait1: &nbsp; &nbsp; &nbsp; ; First wait for vblank to make sure PPU is ready</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BIT $2002</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BPL vblankwait1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">clrmem:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$FE</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $0200, x</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; INX</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BNE clrmem</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >vblankwait2:&nbsp; &nbsp; &nbsp; ; Second wait for vblank, PPU is ready after this</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BIT $2002</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BPL vblankwait2</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Notice that the vblankwait is done twice, so it is a good choice to turn into a
              subroutine.&nbsp; First the vblankwait code is moved outside the normal linear flow:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">vblankwait:&nbsp; &nbsp; &nbsp; ; wait for vblank</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BIT $2002</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BPL vblankwait</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">RESET:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; SEI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable IRQs</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; CLD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable decimal mode</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">clrmem:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$FE</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $0200, x</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; INX</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BNE clrmem</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Then that code needs to be called, so the JSR (Jump to SubRoutine) instruction is where
              the vblankwait code used to be:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">RESET:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; SEI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable IRQs</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; CLD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable decimal mode</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; JSR vblankwait&nbsp; ;;jump to vblank wait #1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">clrmem:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$FE</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $0200, x</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; INX</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BNE clrmem</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; JSR vblankwait&nbsp; ;; jump to vblank wait again</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >And then when the subroutine has finished, it needs to return back to the spot it was
              called from.&nbsp; This is done with the RTS (ReTurn from Subroutine) instruction.&nbsp;
              The RTS will jump back to the next instruction after the JSR:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; vblankwait:&nbsp; &nbsp; &nbsp; ; wait for vblank&nbsp;
              &lt;--------</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; BIT $2002&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; BPL vblankwait&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;----- RTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; RESET:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; SEI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable IRQs &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; CLD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; disable decimal mode &nbsp;
              &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; JSR vblankwait&nbsp; ;;jump to vblank wait #1 --/</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">|</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">\--&gt; clrmem:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; LDA #$FE</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; STA $0200, x</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; INX</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; BNE clrmem</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; JSR vblankwait&nbsp; ;; jump to vblank wait again, returns here</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              ><b
                ><span class="Apple-style-span" style="font-size: medium"
                  >Better Controller Reading</span
                ></b
              ></span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Now that you can set up subroutines, you can do much better controller reading.&nbsp;
              Previously the controller was read as it was processed.&nbsp; With multiple game states,
              that would mean many copies of the same controller reading code.&nbsp; This is replaced
              with one controller reading subroutine that saves the button data into a variable.&nbsp;
              That variable can then be checked in many places without having to read the whole
              controller again.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">ReadController:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$01</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $4016</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA #$00</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; STA $4016</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDX #$08</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">ReadControllerLoop:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; LDA $4016</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; LSR A &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; bit0 -&gt; Carry</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; ROL buttons &nbsp; &nbsp; ; bit0 &lt;- Carry</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; DEX</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; BNE ReadControllerLoop</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; RTS</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              line-height: 11px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >This code uses two new instructions.&nbsp; The first is LSR (Logical Shift Right).&nbsp;
              This takes each bit in A and shifts them over 1 position to the right.&nbsp; Bit 7 is
              filled with a 0, and bit 0 is shifted into the Carry flag.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >bit number&nbsp; &nbsp; &nbsp; 7 6 5 4 3 2 1 0&nbsp; carry</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">original data &nbsp; 1 0 0 1 1 0 1 1&nbsp; 0</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \ \ \ \ \ \ \&nbsp; \</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \ \ \ \ \ \ \&nbsp;
              \&nbsp;</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">shifted data&nbsp; &nbsp; 0 1 0 0 1 1 0 1&nbsp; 1</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Each bit position is a power of 2, so LSR is the same thing as divide by 2.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The next new instruction is ROL (ROtate Left) which is the opposite of LSR.&nbsp; Each bit
              is shifted to the left by one position.&nbsp; The Carry flag is put into bit 0.&nbsp; This
              is the same as a multiply by 2.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >These instructions are used together in a clever way for controller reading.&nbsp; When
              each button is read, the button data is in bit 0.&nbsp; Doing the LSR puts the button data
              into Carry.&nbsp; Then the ROL shifts the previous button data over and puts Carry back to
              bit 0.&nbsp; The following diagram shows the values of Accumulator and buttons data at each
              step of reading the controller:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Accumulator
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; buttons data</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >bit: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7&nbsp; 6&nbsp; 5&nbsp; 4&nbsp; 3&nbsp;
              2&nbsp; 1&nbsp; 0&nbsp; Carry &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7&nbsp; 6&nbsp; 5&nbsp;
              4&nbsp; 3&nbsp; 2&nbsp; 1&nbsp; 0&nbsp; Carry&nbsp;</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >read button A&nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; A&nbsp;
              0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >LSR A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; A &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; A</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >ROL buttons&nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; A &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; A&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >read button B&nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; B&nbsp;
              0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; A&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >LSR A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; B &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; A&nbsp; B</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >ROL buttons&nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; A&nbsp; B&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >read button SEL&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0 SEL 0 &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; A&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >LSR A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0 SEL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; A SEL</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >ROL buttons&nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; A&nbsp; B SEL 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >read button STA&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0 STA 0 &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; A&nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >LSR A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0 STA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; A STA</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >ROL buttons&nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              0&nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; 0&nbsp; 0&nbsp; 0&nbsp;
              A&nbsp; B SEL STA 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              line-height: 11px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              line-height: 11px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The loop continues for a total of 8 times to read all buttons.&nbsp; When it is done there
              is one button in each bit:</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >bit: &nbsp; &nbsp; &nbsp; 7 &nbsp; &nbsp; 6 &nbsp; &nbsp; 5 &nbsp; &nbsp; 4 &nbsp; &nbsp;
              3 &nbsp; &nbsp; 2 &nbsp; &nbsp; 1 &nbsp; &nbsp; 0</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >button:&nbsp; &nbsp; A &nbsp; &nbsp; B &nbsp; select start&nbsp; up &nbsp; down&nbsp; left
              right</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px">If the bit is 1, that button is pressed.</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <br /><span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              ><b
                ><span class="Apple-style-span" style="font-size: medium"
                  >Game Layout<span
                    class="Apple-style-span"
                    style="font-size: 12px; font-weight: normal"
                  ></span></span></b
            ></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              ><b
                ><span class="Apple-style-span" style="font-size: medium"
                  ><span class="Apple-style-span" style="font-size: 12px; font-weight: normal"
                    >The Pong game engine will use the typical simple NES game layout.&nbsp; First all
                    the initialization is done.&nbsp; This includes clearing out RAM, setting up the PPU,
                    and loading in the title screen graphics.&nbsp; Then it enters an infinite loop,
                    waiting for the NMI to happen.&nbsp; When the NMI hits the PPU is ready to accept all
                    graphics updates.&nbsp; There is a short time to do these so code like sprite DMA is
                    done first.&nbsp; When all graphics are done the actual game engine starts.&nbsp; The
                    controllers are read, then game processing is done.&nbsp; The sprite position is
                    updated in RAM, but does not get updated until the next NMI.&nbsp; Once the game
                    engine has finished it goes back to the infinite loop.</span
                  ></span
                ></b
              ></span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >Init Code -&gt; Infinite Loop -&gt; NMI -&gt; Graphics Updates -&gt; Read Buttons -&gt;
              Game Engine --\</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^&nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              \------------------------------------------------------------------/</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <br /><span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
              min-height: 14px;
            "
          >
            <span class="Apple-style-span" style="font-size: 16px; font-weight: bold">Game State</span
            ><span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The use of a "game state" variable is a common way to arrange code.&nbsp; The game state
              just specifies what code should be run in the game engine each frame.&nbsp; If the game is
              in the title screen state, then none of the ball movement code needs to be run.&nbsp; A
              flow chart can be created that includes what each state should do, and the next state that
              should be set when it is done.&nbsp; For Pong there are just 3 basic states.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;-&gt;Title State&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /--&gt; Playing
              State&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /--&gt;&nbsp; Game Over State</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >/ &nbsp;wait for start button --/ &nbsp; &nbsp; move ball &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; wait for start button -\</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; move paddles &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              \</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; check for collisions &nbsp; / &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; check for score = 15 -/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;\ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;
              \-----------------------------------------------------------------------------------/&nbsp;</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <br /><span style="letter-spacing: 0px"></span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >The next step is to add much more detail to each state to figure out exactly what is
              needed.&nbsp; These layouts are done before any significant coding starts.&nbsp; Some of
              the game engine like the second player and the score will be added later.&nbsp; Without the
              score there is no way to get to the Game Over State yet.</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">Title State:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; if start button pressed</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; turn screen off</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; load game screen</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; set paddle/ball position</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; go to Playing State</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; turn screen on</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">Playing State:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; move ball</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if ball moving right</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; add ball speed x to ball position x</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; if ball x &gt; right wall</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; bounce, ball now moving left</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if ball moving left</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; subtract ball speed x from ball position x</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; if ball x &lt; left wall</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; bounce, ball now moving right</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if ball moving up</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; subtract ball speed y from ball position y</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; if ball y &lt; top wall</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; bounce, ball now moving down</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if ball moving down</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; add ball speed y to ball position y</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; if ball y &gt; bottom wall</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; bounce, ball now moving up</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; if up button pressed</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if paddle top &gt; top wall</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; move paddle top and bottom up</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; if down button pressed</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if paddle bottom &lt; bottom wall</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; move paddle top and bottom down</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; if ball x &lt; paddle1x</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; if ball y &gt; paddle y top</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; &nbsp; if ball y &lt; paddle y bottom</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px"
              >&nbsp; &nbsp; &nbsp; &nbsp; bounce, ball now moving left</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">Game Over State:</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; if start button pressed</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; turn screen off</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; load title screen</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; go to Title State</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
            "
          >
            <span style="letter-spacing: 0px">&nbsp; &nbsp; turn screen on</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px">&nbsp;</span>
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span style="letter-spacing: 0px"></span><br />
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 0px;
              margin-left: 0px;
              line-height: 11px;
              font: normal normal normal 10px / normal Monaco;
              min-height: 14px;
            "
          >
            <span
              class="Apple-style-span"
              style="font-family: Helvetica; font-size: 16px; font-weight: bold"
              >Putting It All Together</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Download and unzip the
              <a
                href="scraper/files/pong1.zip"
                target="_blank"
                original-href="http://www.nespowerpak.com/nesasm/pong1.zip"
                >pong1.zip</a
              >
              sample files.&nbsp; The playing game state and ball movement code is in the pong1.asm file.
              Make sure that file, mario.chr, and pong1.bat is in the same folder as NESASM3, then double
              click on pong1.bat. That will run NESASM3 and should produce pong1.nes. Run that NES file
              in FCEUXD SP to see the ball moving!</span
            >
          </p>
          <p
            style="
              margin-top: 0px;
              margin-right: 0px;
              margin-bottom: 12px;
              margin-left: 0px;
              font: normal normal normal 12px / normal Helvetica;
            "
          >
            <span style="letter-spacing: 0px"
              >Other code segments have been set up but not yet completed.&nbsp; See how many of those
              you can program yourself.&nbsp; The main parts missing are the paddle movements and
              paddle/ball collisions.&nbsp;&nbsp;You can also add the intro state and the intro screen,
              and the playing screen using the background information from the previous week.</span
            >
          </p>
        </div>
        <div><br /></div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-7__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=8747"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-8">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 8: 16 bit math, pointers, nested loops</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <b>This Week:</b> The NES is an 8 bit machine, but sometimes you need more! Learn to handle 16+
        bit numbers, and use them for bigger loops.<br />
        <br />
        <span class="Apple-style-span" style="font-size: medium"><b>16 Bit Math</b></span
        ><br />
        Doing 16 bit addition and subtraction is fairly simple because of the carry flag that we had
        previously been clearing. First the normal add is done using the clc/adc pair. This add is for
        the lower 8 bits of the 16 bit number. For the upper 8 bits the adc instruction is used again,
        but without the clc. You want to keep the carry from the first add, in case it overflowed. To
        only add in the carry the second adc value is just 0.<br />
        <br />
        Here are some examples in decimal. One digit column is added at a time. The carry (1) is added to
        the next column as needed. <br />
        <pre>
    0 3
+   0 4
0 7  (no carry needed, top digit = 0)
</pre
        >
        <br />
        <pre>
    0 4
+   0 8
1 2  (carry only, top digit = 1)
</pre
        >
        <br />
        <pre>
    2 2
+   1 9
4 1  (carry plus 2 plus 1, top digit = 4)
</pre
        >
        <br />
        And the code to do it on the NES, adding 1 to a 16 bit number:<br />
        <pre>
  LDA lowbyte      ; load low 8 bits of 16 bit value
CLC              ; clear carry
ADC #$01         ; add 1
STA lowbyte      ; done with low bits, save back
LDA highbyte     ; load upper 8 bits
ADC #$00         ; add 0 and carry from previous add
STA highbyte     ; save back</pre
        >
        <br />
        The same process of adding 0 without clearing the carry can be continued to do 24 bit, 32 bit, or
        higher numbers. It is also the same process to do 16 bit subtraction:<br />
        <pre>
  LDA lowbyte      ; load low 8 bits of 16 bit value
SEC              ; set carry
SBC #$01         ; subtract 1
STA lowbyte      ; done with low bits, save back
LDA highbyte     ; load upper 8 bits
SBC #$00         ; subtract 0 and carry from previous sub
STA highbyte     ; save back</pre
        >
        <br />
        <br /><span class="Apple-style-span" style="font-size: medium"
          ><b> Pointers and Indirect Indexed Mode</b></span
        ><br />
        Previously when loading background tiles the x register was used as an 8 bit offset. Now that we
        can handle 16 bit numbers a different addressing mode can be used. The 16 bit address is saved
        into two 8 bit variables, which are then used as a "<b>pointer</b>" which points to the
        background data we want. The LDA instruction then uses the "<b>Indirect Indexed</b>" addressing
        mode. This takes the 16 bit variable inside the brackets and uses it as an address. For the
        address to be correct, the low byte must be first and the high byte must come immediately after.
        Then the value in the Y register is added to the address. This forms the final address to load
        from. Both variables must also be in the first 256 bytes of RAM, called "<b>Zero Page</b>", and
        the X register cannot be used with this addressing mode.<br />
        <pre>
  .rsset $0000       ; put pointers in zero page
pointerLo  .rs 1   ; pointer variables are declared in RAM
pointerHi  .rs 1   ; low byte first, high byte immediately after
</pre
        >
        <pre>
  LDA #$D0
STA pointerHi
LDA #$12
STA pointerLo       ; pointer now says $D012
</pre
        >
        <pre>
  LDY #$00            ; no offset from Y
LDA [pointerLo], y  ; load data from the address pointed to by the 16 bit pointer variable plus the value in the Y register
</pre
        >
        <br />
        That last line is the same as
        <pre>LDA $D012, y</pre>
        Because we kept Y = 0, that is the same as
        <pre>LDA $D012</pre>
        <br /><b><span class="Apple-style-span" style="font-size: medium"> Copy Loops </span></b><br />
        Now using your 16 bit math the pointer address can be incremented. Instead of being limited to
        256 background tiles like when using the x offset, the whole background can be copied in one
        loop. First the address of the background data is put into the pointer variable. The high and low
        bytes of the address are each copied individually. Then the number of tiles to copy is put into
        the loop counter, which will count down to 0. Each time through the loop one byte will be copied,
        the 16 bit pointer address will be incremented, and the 16 bit loop counter will be decremented.
        The Y offset is always kept at 0, because the pointer always points to the correct byte. When the
        loop counter reaches 0 everything is done. <br />
        <pre>
  LDA #LOW(background)
STA pointerLo       ; put the low byte of the address of background into pointer
LDA #HIGH(background)
STA pointerHi       ; put the high byte of the address into pointer
</pre
        >
        <pre>
  LDA #$00
sta counterLo       ; put the loop counter into 16 bit variable
LDA #$04
sta counterHi       ; count = $0400 = 1KB, the whole screen at once including attributes
</pre
        >
        <pre>
  
LDY #$00            ; put y to 0 and don't change it
LoadBackgroundLoop:
LDA [pointerLo], y
STA $2007           ; copy one background byte
</pre
        >
        <pre>
  LDA pointerLo
CLC
ADC #$01
STA pointerLo
LDA pointerHi
ADC #$00
STA pointerHi       ; increment the pointer to the next byte
</pre
        >
        <pre>
  
LDA counterLo
SEC
SBC #$01
STA counterLo
LDA counterHi
SBC #$00
STA counterHi       ; decrement the loop counter
</pre
        >
        <pre>
  
LDA counterLo
CMP #$00
BNE LoadBackgroundLoop
LDA counterHi
CMP #$00
BNE LoadBackgroundLoop  ; if the loop counter isn't 0000, keep copying
&nbsp;</pre
        >
        That is a lot of code to copy just one byte!
        <br />
        <br /><span class="Apple-style-span" style="font-size: medium"><b> Nested Loops</b></span
        ><br />
        To avoid using so much code, we can use both the X and Y registers as loop counters. By putting
        one loop inside another loop we create a "nested loop". First the inside loop counts all the way
        up. Then the outside loop counts up once, and the inside loop counts all the way again. Normally
        using only X or Y would only give a maximum of 256 times through a loop like we have previously
        done. With nested loops using both X and Y the maximum is the inside counter multiplied by the
        outside counter, or 256*256 = 65536.
        <br />
        <pre>
  LDX #$00
LDY #$00
OutsideLoop:

InsideLoop:
;
; this section runs 256 x 256 times
;

INY                 ; inside loop counter
CPY #$00
BNE InsideLoop      ; run the inside loop 256 times before continuing down

INX
CPX #$00
BNE OutsideLoop     ; run the outside loop 256 times before continuing down
</pre
        >
        <div><br /></div>
        First the Inside Loop runs and Y will count from 0 to 256. When that finishes X will count 0 to
        1, and branch back to the beginning of the loops. Then the Inside Loop runs again, Y 0 -&gt; 256.
        X now goes 1 -&gt; 2 and the process continues. Everything ends when both X and Y have each
        counted to 256.
        <br />
        <br />
        When we are using nested loops to copy entire backgrounds we want 256 x 4 = 1KB. The Y code from
        above can be unchanged, but the X code is changed to CPX #$04.
        <br /><br />
        Because we are changing the Y register our previous pointer copying code also needs to be
        modified. Instead of incrementing the pointer every time, the incrementing Y register is doing
        the same thing. The low byte of the pointer will be kept at 0. This means your background data
        needs to be aligned to where the low byte of the address is $00. However the high byte of the
        pointer still needs to change. By always making the inside loop count 256 times, that will end at
        the same time that the high byte needs to change. This time 16 bit math isn't needed because only
        the high byte is incremented.
        <br /><br />
        No loop counter is used because X and Y are used instead. If you cannot align your data so the
        low byte of the address is $00, you will have to use the CopyLoop above.<br />
        <pre>
  LDA #$00
STA pointerLo       ; put the low byte of the address of background into pointer
LDA #HIGH(background)
STA pointerHi       ; put the high byte of the address into pointer

LDX #$00            ; start at pointer + 0
LDY #$00
OutsideLoop:

InsideLoop:
LDA [pointerLo], y  ; copy one background byte from address in pointer plus Y
STA $2007           ; this runs 256 * 4 times

INY                 ; inside loop counter
CPY #$00
BNE InsideLoop      ; run the inside loop 256 times before continuing down

INC pointerHi       ; low byte went 0 to 256, so high byte needs to be changed now

INX
CPX #$04
BNE OutsideLoop     ; run the outside loop 256 times before continuing down
</pre
        >
        <br /><span class="Apple-style-span" style="font-size: medium"
          ><b> Putting It All Together</b></span
        ><br />
        Download and unzip the
        <a
          href="scraper/files/background3.zip"
          target="_blank"
          original-href="http://www.nespowerpak.com/nesasm/background3.zip"
          >background3.zip</a
        >
        sample files. All the code is in the background.asm file. Make sure that file, mario.chr, and
        background.bat is in the same folder as NESASM, then double click on background.bat. That will
        run NESASM and should produce background3.nes. Run that NES file in FCEUXD SP to see the full
        background. <br /><br />
        The new nested loop is used to copy a whole background to the screen instead of only 128 bytes.
        &nbsp;The background is aligned using the .org directive so the low address byte is $00.
        &nbsp;The attributes are also placed directly after the background data so it is are copied at
        the same time.
        <div><br /></div>
        <div>
          Your task is to separate out the code that sets the pointer variables from the code that copies
          the loop. That way you can have multiple backgrounds that use different pointer loading code,
          but the same copy code. <br /><br />
          If you are using a different assembler, the Indirect Indexed mode may use () instead of []. The
          LOW() and HIGH() syntax may also be different.<br /><br />
        </div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-8__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=33274"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
    <div class="tutorialCard mdl-card mdl-shadow--2dp" id="main_tutorial-9">
      <div class="mdl-card__title">
        <h2 class="mdl-card__title-text">Nerdy Nights week 9: Numbers, Bin to Dec</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <b>This Week</b>: NES uses binary and hex, but your gamers want to read in decimal? Here are two
        solutions for displaying scores and other numbers in a readable way.<br />
        <br /><span class="Apple-style-span" style="font-size: medium"><b> BCD Mode</b></span
        ><br />
        The 6502 processor has a mode called BCD, or Binary Coded Decimal, where the adc/sbc instructions
        properly handle decimal numbers instead of binary numbers. The NES is not a full 6502 processor
        and does not include this mode. Be careful when you are searching for code to not copy any that
        uses that mode, or you will get incorrect results. If the code is doing a SED instruction, it is
        enabling the decimal mode and you should not use it. Instead you get to do all the decimal
        handling yourself!
        <br />
        <br /><b><span class="Apple-style-span" style="font-size: medium"> Storing Digits</span></b
        ><br />
        The first method uses more code, but may be easier to understand. Say your score is a 5 digit
        number. You will make 5 variables, one for each digit. Those variables will only count from 0 to
        9 so you need to write code to handle addition and subtraction. Super Mario uses this method.
        It's lowest digit is always 0, so that isn't actually stored in a variable. Instead it is just a
        permanent part of the background.
        <br /><br />
        We will start with just incrementing a 3 digit number to see how its done:<br />
        <pre>
IncOnes:
LDA onesDigit     ; load the lowest digit of the number
CLC 
ADC #$01          ; add one
STA onesDigit
CMP #$0A          ; check if it overflowed, now equals 10
BNE IncDone       ; if there was no overflow, all done
IncTens:
LDA #$00
STA onesDigit     ; wrap digit to 0
LDA tensDigit     ; load the next digit
CLC 
ADC #$01          ; add one, the carry from previous digit
STA tensDigit
CMP #$0A          ; check if it overflowed, now equals 10
BNE IncDone       ; if there was no overflow, all done
IncHundreds:
LDA #$00
STA tensDigit     ; wrap digit to 0
LDA hundredsDigit ; load the next digit
CLC 
ADC #$01          ; add one, the carry from previous digit
STA hundredsDigit
IncDone:
</pre
        >
        <br />
        When the subroutine starts, the ones digit is incremented. Then it is checked if it equals $0A
        which is decimal 10. That number doesn't fit in just one digit, so the ones digit is set to 0 and
        the tens digit is incremented. The tens digit is then checked in the same way, and the chain
        continues for as many digits as you want.<br />
        <br />
        The same process is used for decrementing, except you check for underflow (digit=$FF) and wrap
        the digit to $09.<br />
        <br />
        Adding two numbers is the same idea, except other than checking if each digit equals $0A you need
        to check if the digit is $0A or above. So instead of BEQ the opcode will be BCC.<br />
        <pre>
AddOnes:
LDA onesDigit      ; load the lowest digit of the number
CLC 
ADC onesAdd        ; add new number, no carry
STA onesDigit
CMP #$0A           ; check if digit went above 9. If accumulator &gt;= $0A, carry is set
BCC AddTens        ; if carry is clear, all done with ones digit
       ; carry was set, so we need to handle wrapping
LDA onesDigit
SEC
SBC #$0A           ; subtract off what doesnt fit in 1 digit
STA onesDigit      ; then store the rest
INC tensDigit      ; increment the tens digit
AddTens:
LDA tensDigit      ; load the next digit
CLC
ADC tensAdd        ; add new number
STA tensDigit
CMP #$0A           ; check if digit went above 9
BCC AddHundreds    ; no carry, digit done
LDA tensDigit
SEC
SBC #$0A           ; subtract off what doesnt fit in 1 digit
STA tensDigit      ; then store the rest
INC hundredsDigit  ; increment the hundreds digit
AddHundreds:
LDA hundredsDigit  ; load the next digit
CLC
ADC hundredsAdd    ; add new number
STA hundredsDigit
AddDone:
</pre
        >
        <br />
        When that code is all done, the ones/tens/hundreds digits will hold the new value. With both code
        samples there is no check at the end of the hundreds digit. That means when the full number is
        999 and you add one more, the result will be wrong! In your code you can either wrap around all
        the digits to 0, or set all the digits to 999 again for a maximum value. Of course if your
        players are hitting the max they likely want more digits!
        <div>
          <br />
          <br /><span class="Apple-style-span" style="font-size: medium"
            ><b> Binary to Decimal Conversion</b></span
          ><br />
          The second method of handling number displays uses less code, but could use much more CPU time.
          The idea is to keep you numbers in plain binary form (8 or 16 bit variables) for the math, then
          convert them to decimal for displaying only. An 8 bit binary value will give you 3 decimal
          digits, and a 16 bit binary will give 5 decimal digits.<br />
          <br />
          This first example is coded to be understandable, not fast or small. Each step compares the
          binary value to a significant decimal value (100 and then 10). If the binary is larger, that
          value is subtracted from the binary and the final decimal digit is incremented. So for a text
          example:
          <br />
          <pre>
initial binary: 124
initial decimal: 000
</pre
          >
          <pre>
1: compare to 100
2: 124 greater than 100, so subtract 100 and increment the decimal hundreds digit
3: repeat hundreds again
</pre
          >
          <pre>
current binary: 024
current decimal: 100
</pre
          >
          <pre>
1: compare to 100
2: 024 less than 100, so all done with hundreds digit
</pre
          >
          <pre>
current binary: 024
current decimal: 100
</pre
          >
          <pre>
1: compare to 10
2: 024 greater than 10, so subtract 10 and increment the decimal tens digit
3 repeat tens again
</pre
          >
          <pre>
current binary: 014
current decimal: 110
</pre
          >
          <pre>
1: compare to 10
2: 014 greater than 10, so subtract 10 and increment the decimal tens digit
3 repeat tens again
</pre
          >
          <pre>
current binary: 004
current decimal: 120
</pre
          >
          <pre>
etc for ones digit
</pre
          >
          <br />
          You can see this will transfer the binary to decimal one digit at a time. For numbers with
          large digits (like 249) this will take longer than numbers with small digits (like 112). Here
          is the code:
          <br />
          <pre>
HundredsLoop:
LDA binary
CMP #100             ; compare binary to 100
BCC TensLoop         ; if binary &lt; 100, all done with hundreds digit
LDA binary
SEC
SBC #100
STA binary           ; subtract 100, store whats left
INC hundredsDigit    ; increment the digital result
JMP HundredsLoop     ; run the hundreds loop again
</pre
          >
          <pre>
TensLoop:
LDA binary
CMP #10              ; compare binary to 10
BCC OnesLoop         ; if binary &lt; 10, all done with hundreds digit
LDA binary
SEC
SBC #10
STA binary           ; subtract 10, store whats left
INC tensDigit        ; increment the digital result
JMP TensLoop         ; run the tens loop again
</pre
          >
          <pre>
OnesLoop:
LDA binary
STA onesDigit        ; result is already under 10, can copy directly to result
</pre
          >
          <br />
          This code can be expanded to 16 bit numbers, but the compares become harder. Instead a more
          complex series of loops and shifts with a table is used. This code does shifting of the binary
          value into the carry bit to tell when to add numbers to the final decimal result. I did not
          write this code, it came from a post by Tokumaru at
          <a
            href="http://nesdev.parodius.com/bbs/viewtopic.php?p=10824&amp;sid=55359b42282d1e02b91bebcf1caf56ef#10824"
            target="_blank"
            original-href="http://nesdev.parodius.com/bbs/viewtopic.php?p=10824&amp;sid=55359b42282d1e02b91bebcf1caf56ef#10824"
            >http://nesdev.parodius.com/bbs/vi...</a
          >
          There are many more examples of different conversion styles at that forum thread. <br /><br />
          Notice there are no branches other than the loop running 16 times (one for each binary input
          bit), so the conversion always takes the same number of cycles.
          <br />
          <pre>
  tempBinary - 16 bits input binary value
decimalResult - 5 bytes for the decimal result
</pre
          >
          <pre>
BinaryToDecimal:
lda #$00 
sta decimalResult+0
sta decimalResult+1
sta decimalResult+2
sta decimalResult+3
sta decimalResult+4
ldx #$10 
BitLoop: 
asl tempBinary+0 
rol tempBinary+1
ldy decimalResult+0
lda BinTable, y 
rol a
sta decimalResult+0
ldy decimalResult+1
lda BinTable, y 
rol a
sta decimalResult+1
ldy decimalResult+2
lda BinTable, y 
rol a
sta decimalResult+2
ldy decimalResult+3
lda BinTable, y 
rol a
sta decimalResult+3
rol decimalResult+4
dex 
bne BitLoop 
rts 
BinTable:
.db $00, $01, $02, $03, $04, $80, $81, $82, $83, $84
</pre
          >
          <br />
          <br /><b><span class="Apple-style-span" style="font-size: medium"> Displaying Numbers</span></b
          ><br />
          Once you have your numbers in decimal format you need to display them on the screen. With the
          code above all the results have 00000 = $00 $00 $00 $00 $00. If your background tiles for
          digits start at tile 0 then that will work fine. However if you are using ASCII you will need
          to add an offset to each digit. The ASCII code for the digit 0 is $30, so you just add $30 to
          each digit before writing it to the background. If your code uses the first method of
          compare/wrapping digits, then you could compare to $3A and wrap to $30 to automatically handle
          this. You would just need to make sure you set each digit to $30 instead of $00 when clearing
          the number to 00000. You have control over where background tiles are located, so the offset
          for the digit tiles can be whatever you choose.
          <br />
          <br /><b
            ><span class="Apple-style-span" style="font-size: medium"> Putting It All Together</span></b
          ><br />
          Download and unzip the
          <a
            href="scraper/files/pong2.zip"
            target="_blank"
            original-href="http://www.nespowerpak.com/nesasm/pong2.zip"
            >pong2.zip</a
          >
          sample files. The playing game state and ball movement code is in the pong2.asm file. Make sure
          that file, mario.chr, and pong2.bat is in the same folder as NESASM3, then double click on
          pong1.bat. That will run NESASM3 and should produce pong2.nes. Run that NES file in FCEUXD SP
          to see the score! Right now the score just increments every time the ball bounces off a side
          wall.<br />
          <br />
          Try making two scoring variables and drawing them both. You can also use the other binary to
          decimal converters to add more than 1 to the score each time. In the DrawScore you can also
          check the score digits and not draw any leading zeros. Instead replace them with spaces when
          you are drawing to the background.
        </div>
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="#main_tutorial-toc"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Back to Table of Contents
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <a
          class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect"
          href="javascript:doCommentToggle('main_tutorial-9__comments');"
          data-upgraded=",MaterialButton,MaterialRipple"
        >
          Toggle Comments
          <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
        ></a>
        <div style="float: right">
          <a
            class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect mdl-button--accent"
            href="http://nintendoage.com/forum/messageview.cfm?catid=22&amp;threadid=33308"
            target="_blank"
            data-upgraded=",MaterialButton,MaterialRipple"
          >
            Original Article
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span
          ></a>
        </div>
      </div>
    </div>
  </body>
</html>
